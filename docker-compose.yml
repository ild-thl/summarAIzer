services:
    summaraizer:
        image: pascalhuerten/summaraizer:latest
        container_name: summaraizer
        build: .
        ports:
            - "7860:7860"
        volumes:
            # Use Docker-managed volumes instead of bind mounts for better compatibility
            - summaraizer_resources:/app/resources
            - summaraizer_prompts:/app/prompts
        environment:
            GRADIO_SERVER_NAME: 0.0.0.0
            GRADIO_SERVER_PORT: 7860
            PYTHONUNBUFFERED: "1"
        restart: unless-stopped
        healthcheck:
            test: ["CMD", "curl", "-f", "http://localhost:7860/"]
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 40s
        # Optional: Resource limits
        deploy:
            resources:
                limits:
                    memory: 2G
                reservations:
                    memory: 1G

# Docker-managed volumes for persistent data
volumes:
    summaraizer_resources:
        driver: local
    summaraizer_prompts:
        driver: local
